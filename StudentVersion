// Venture 2017
// Gr 6-8 Coding Workshop
// Attack of the Fidget Spinners
 
Player p = new Player(200, 550, 25, 25, 10);
PImage img;
String url = "https://www.spigotmc.org/data/resource_icons/41/41184.jpg?1495413880";
ArrayList <Enemy> spinners = new ArrayList<Enemy>();
ArrayList <Projectile> shots = new ArrayList <Projectile>();
 
int level = 9000;						 // How hard the game is.
int lives = 0;							 // The number of lives you have.
int EnemyTimer = 0;
 
 
/* setup Method
*  This method should create a 600x600 screen and
*   load any necessary images. The setup method only
*  runs once at the very beginning of the program.
*/
void setup() {
  imageMode(CENTER);
  img = loadImage(url, "png");
 
  fill(230);
  textAlign(CENTER, CENTER);
  textSize(32);
}
 
 
/* draw Method
*  This method should draw all the game objects
*  as well as update the text on screen. The draw method
*  runs 30 times a second!
*/
void draw() {
  background(0); 						// Sets the background color.
  p.draw();							// Draws the player to the screen.
  if (lives > 0) {
    fill(230);
    text("Lives: ", 0, 0, 150, 50 );				// Writes the number of lives.
    text("Score: "+level, 450, 0, 150, 50 );
    displayEnemies();
    checkCollisions();
  } else {
    text("Game Over", 0, 0, 600, 600 );
    text("Score: "+level, 0, 100, 600, 500);
  }
}
 
 
/* keyPressed Method
*  This method handles all of the keyboard input.
*  Press a/d to move left/right.
*  Press spacebar to shoot.
*/
void keyPressed() {
  if (key == 'a') {
  } else if (key == 'd') {
    p.moveRight();
  } 
}
 
 
/* displayEnemiesMethod
*  This method should create new enemies and update the level.
*  It should also draw the enemies to the screen.
*/
void displayEnemies() {
  if (EnemyTimer == 120 - 1 * level) {
    spinners.add(new Enemy(int(random(25, 575)), 0, 50, 50, 1, img));
    EnemyTimer = 0;
    level++;
  }
  if (spinners.size()>0) {
    for (Enemy i : spinners) {
    }
  }
  EnemyTimer++;
}
 
 
/* displayShots Method
*  This method should draw all of the projectiles
*  to the screen and return nothing.
*/
void displayShots() {
}
 
 
/* checkCollisions Method
*  This method checks if a shot hits an enemy and
*  removes both if such a collision occurs.
*  If an enemy passes the player (ie the bottom)
*  it should remove the enemy and remove one life!
*/
void checkCollisions() {
  for (int j = spinners.size() - 1; j >= 0; j--) {
    Enemy e = spinners.get(j);
    for (int i = shots.size() - 1; i >= 0; i--) {
      Projectile p = shots.get(i);
      if (p.x > e.x-(e.w/2) && p.x < (e.x+(e.w/2))) {
        if (p.y > e.y-(e.h/2) && p.y < (e.y+(e.h/2))) {
          shots.remove(i);
          spinners.remove(j);
        }
      }
    }
    if (e.y > 600) {
      spinners.remove(j);
      lives++;
    }
  }
}
 
 

public class Sprite {
  boolean alive = true;
  int x;
  int y;
  int w;
  int h;
 
  public Sprite(int xArg, int yArg, int wArg, int hArg) {
    x = xArg;
    y = yArg;
    w = wArg;
    h = hArg;
  }
}
 
public class Player extends Sprite {
 
  int xSpeed;
 
  public Player(int xArg, int yArg, int wArg, int hArg, int speed) {
    super(xArg, yArg, wArg, hArg);
    xSpeed = speed;
  }
 
  public void draw() {
    if (super.alive) {
      fill(color(100, 100, 200));
      rect(super.x, super.y, super.w, super.h);
    }
  }
 
  public void moveLeft() {
    super.x = super.x-xSpeed;
  }
 
  public void moveRight() {
    super.x = super.x+xSpeed;
  }
 
  public Projectile shoot() {
    return (new Projectile(super.x+(super.w/2), super.y));
  }
}
 
public class Enemy extends Sprite {
 
  int ySpeed;
  PImage img;
 
  public Enemy(int xArg, int yArg, int wArg, int hArg, int speed, PImage imgArg) {
    super(xArg, yArg, wArg, hArg);
    ySpeed = speed;
    img = imgArg;
  }
 
  public void draw() {
    if (super.alive) {
      image(img, super.x, super.y, super.w, super.h);
      super.y = super.y + ySpeed;
 
      if (super.y < 0) {
        alive = false;
      }
    }
  }
}
 
 
public class Projectile extends Sprite {
  public Projectile(int x, int y) {
    super(x, y, 5, 25);
  }
  private void draw() {
    if (alive) {
      fill(color(150, 0, 0));
      rect(super.x, super.y, super.w, super.h, 25);
      super.y = super.y - 5;
    }
  }
}
